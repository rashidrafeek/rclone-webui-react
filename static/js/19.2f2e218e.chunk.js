(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{427:function(e,t,a){"use strict";var n=a(1);n.oneOfType([n.shape({Features:n.object.isRequired,Hashes:n.array.isRequired,Name:n.string.isRequired,Precision:n.number.isRequired,String:n.string.isRequired}),n.object]),n.shape({remoteName:n.string.isRequired,remotePath:n.string.isRequired}),n.string,n.bool,n.bool,n.shape({Path:n.string.isRequired,Name:n.string.isRequired,Size:n.number,MimeType:n.string,ModTime:n.string.isRequired,IsDir:n.bool.isRequired}),n.shape({rate:n.string.isRequired})},720:function(e,t){},801:function(e,t,a){"use strict";a.r(t);var n=a(38),r=a(39),o=a(90),l=a(89),c=a(142),i=a(91),s=a(0),u=a.n(s),m=a(88),d=a(138),p=a(429),f=a(443),h=a(516),g=a(444),b=a(517),E=a.n(b),v=function(e,t){var a=t.trim().toLowerCase(),n=a.length;return 0===n?e:0===n?[]:e.filter(function(e){return e.toLowerCase().slice(0,n)===a})},y=function(e){return e},N=function(e){return u.a.createElement("div",null,e)},k=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(l.a)(t).call(this,e))).onSuggestionsFetchRequested=function(e){var t=e.value;a.setState({suggestions:v(a.props.suggestions,t)})},a.onSuggestionsClearRequested=function(){a.setState({suggestions:[]})},a.state={suggestions:[]},a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t={placeholder:"Type the name of remote you want to open",value:e.value,onChange:e.onChange};return u.a.createElement(E.a,{suggestions:this.state.suggestions,onSuggestionsFetchRequested:this.onSuggestionsFetchRequested,onSuggestionsClearRequested:this.onSuggestionsClearRequested,getSuggestionValue:y,renderSuggestion:N,highlightFirstSuggestion:!0,inputProps:t})}}]),t}(u.a.Component),O=a(140),w=a(21),j=a(104),C=a(2),D=a(105),I=function(e,t,a){return function(n){n({type:C.h,remoteName:t,id:e,remotePath:a}),n(P(e))}},F=function(e,t){return function(a){a({type:C.i,remoteName:t,id:e,remotePath:""}),a(P(e))}},P=function(e){return function(t,a){var n=a().explorer.currentPaths[e],r=n.remoteName,o=n.remotePath;r&&""!==r&&t(T(r,o))}},S=function(e){return function(t){t({type:C.m,id:e})}},M=function(e){return function(t){t({type:C.z,id:e}),t(P(e))}},x=function(e){return function(t){t({type:C.y,id:e}),t(P(e))}},R=function(e){return function(t){t({type:C.x,id:e}),t(P(e))}},L=a(67),T=function(e,t){return function(a){if(""!==e){var n={fs:0!==e.indexOf("/")?Object(D.a)(e):e,remote:t},r="".concat(e,"-").concat(t);j.a.post(L.a.getFilesList,n).then(function(e){return a({type:C.s,status:C.C,payload:{path:r,filesList:e.data.list}})},function(e){return a({type:C.s,status:C.A,payload:{path:r,error:e}})})}}},H=a(445),A=(a(427),function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(l.a)(t).call(this,e))).shouldUpdateRemoteName=function(e,t){var n=t.newValue;0===n.indexOf("/")?a.setState({remoteName:n,openButtonText:"Open local path"}):a.setState({remoteName:n,openButtonText:"Open"})},a.openRemote=function(e){e.preventDefault();var t=a.props,n=t.changeRemoteName,r=t.containerID,o=a.state.remoteName;n(r,o),a.props.getFsInfo(o)},a.state={isEmpty:!1,remoteName:e.remoteName,openEnabled:!1,openButtonText:"Open"},a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.getRemoteNames()}},{key:"render",value:function(){var e=this.state,t=e.isEmpty,a=e.remoteName,n=this.props.remotes;return this.props.hasError?u.a.createElement("div",null,"Error loading remotes. Please try again."):t?u.a.createElement("div",null,"Add some remotes to see them here ",u.a.createElement("span",{role:"img","aria-label":"sheep"},"\ud83d\udc11"),"."):u.a.createElement(H.a,{onSubmit:this.openRemote},u.a.createElement(d.a,null,u.a.createElement(m.a,{xs:12,sm:10,lg:8},u.a.createElement(k,{value:a,onChange:this.shouldUpdateRemoteName,suggestions:n})),u.a.createElement(m.a,{xs:12,sm:2,lg:4},u.a.createElement(p.a,{className:"btn-lg",color:"success"},this.state.openButtonText))))}}]),t}(u.a.Component));A.defaultProps={};var B=Object(O.b)(function(e,t){return{remotes:e.remote.remotes,hasError:!1,error:e.remote.error,currentPath:e.explorer.currentPaths[t.containerID]}},{getRemoteNames:function(){return function(e,t){var a=t();(!a.remote.remotes||a.remote.remotes.length<1)&&j.a.post(L.a.listRemotes).then(function(t){return e({type:C.v,status:C.C,payload:t.data.remotes})},function(t){return e({type:C.v,status:C.A,payload:t})})}},getFsInfo:function(e){return function(t){var a,n;Object(D.i)(e)?a=n="/":(n=e.split(":")[0],a=Object(D.a)(n)),j.a.post(L.a.getFsInfo,{fs:a}).then(function(e){t({type:C.r,status:C.C,payload:Object(w.a)({},n,e.data)})},function(e){return t({type:C.r,status:C.A,payload:e})})}},changeRemoteName:F})(A),U=a(106),V=a.n(U),q=a(144),G=a(794),Q=a(420),z=a(668),W=a(499),J=a(485),Y=a(795),K=a(796),X=a(797),Z=a(798),$=a(556),_="FileComponent",ee=a(143),te=a(708),ae=a.n(te),ne=a(426),re=a(808),oe=a(52),le=a(53),ce=a(141),ie=a(717),se=a.n(ie),ue=function(e){function t(){return Object(n.a)(this,t),Object(o.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(r.a)(t,[{key:"error",value:function(){console.log("error")}},{key:"render",value:function(){var e=this.props.options;return u.a.createElement(se.a,{options:e,error:this.error})}}]),t}(u.a.Component);var me=function(e){var t,a=e.playbackURL,n=e.MimeType,r=Object(s.useState)(!0),o=Object(ne.a)(r,2),l=o[0],c=o[1];function i(e){e.stopPropagation(),c(!l)}if(l)t=u.a.createElement("div",{className:"img-thumbnail w-100 text-center","data-test":"videoPlayerWidget"},u.a.createElement(p.a,{color:"link",onClick:i},u.a.createElement("i",{className:"fa fa-play-circle fa-4x"})));else{var m=a.substring(0,a.lastIndexOf("."))+".vtt";console.log(m);var d={options:{sources:[{type:n,src:a}],subtitles:[{language:"en",url:m,label:"EN"}]}};t=oe.createPortal(u.a.createElement(re.a,{className:"task-modal d-none d-sm-block","data-test":"videoPlayerWidget",isOpen:!l,toggle:i},u.a.createElement(ue,d)),document.getElementById(le.d))}return u.a.createElement(ce.a,null,t)};var de=Object(O.b)(function(e,t){var a=t.downloadURL;return{imageData:e.imageLoader[a]}},{downloadImage:function(e){return function(t){if(!e)throw new Error("Cannot have null url");t({type:C.w,status:C.B,payload:{url:e}}),j.a.get(e,{responseType:"arraybuffer"}).then(function(a){console.log(a);var n=new Blob([a.data]),r=URL.createObjectURL(n);t({type:C.w,status:C.C,payload:{url:e,data:r}})},function(a){t({type:C.w,status:C.A,payload:{url:e,error:a}})})}}})(function(e){var t=e.downloadURL,a=e.inViewport,n=e.imageData,r=e.downloadImage,o=(e.currentPath,Object(s.useState)(!0)),l=Object(ne.a)(o,2),c=l[0],i=l[1],b=Object(s.useState)(0),E=Object(ne.a)(b,2),v=E[0],y=E[1];function N(e){e.stopPropagation(),i(!c)}if(Object(s.useEffect)(function(){a&&t&&!n&&r(t)}),c)return u.a.createElement("div",{onClick:N,"data-test":"toggleModal"},!n||n.isLoading?u.a.createElement(G.a,null,"Loading..."):u.a.createElement("img",{className:"img-thumbnail pd-0 m-0 -rotate-90",src:n.data,alt:""}));var k=u.a.createElement("button",{className:"close",style:{position:"absolute",top:"15px",right:"15px"},onClick:N},u.a.createElement("i",{className:"fa fa-close fa-inverse"}));return oe.createPortal(u.a.createElement(re.a,{className:"image-modal",isOpen:!c,toggle:N,external:k},u.a.createElement(Q.a,{fluid:!0},u.a.createElement(d.a,null,u.a.createElement(m.a,{lg:8},u.a.createElement("img",{className:"rotatableImage img-thumbnail pd-0 m-0 "+(0!==v?"rotate"+v:""),src:n.data,alt:""})),u.a.createElement(m.a,{lg:4},u.a.createElement(f.a,null,u.a.createElement(h.a,null,"Operations"),u.a.createElement(g.a,null,u.a.createElement(d.a,null,u.a.createElement(p.a,{color:"link",onClick:function(){y(v>0?(v-90)%360:(360-v-90)%360)}},u.a.createElement("i",{className:"fa fa-rotate-left"})),u.a.createElement(p.a,{color:"link",onClick:function(){y((v+90)%360)}},u.a.createElement("i",{className:"fa fa-rotate-right"}))))))))),document.getElementById(le.d))});var pe=function(e){var t,a=e.playbackURL,n=e.MimeType,r=Object(s.useState)(!0),o=Object(ne.a)(r,2),l=o[0],c=o[1];function i(e){e.stopPropagation(),c(!l)}return t=l?u.a.createElement("div",{className:"img-thumbnail w-100 text-center","data-test":"audioPlayerWidget"},u.a.createElement(p.a,{color:"link",onClick:i},u.a.createElement("audio",{controls:!0},u.a.createElement("source",{src:a,type:n}),"Your browser does not support the audio tag."))):oe.createPortal(u.a.createElement(re.a,{className:"task-modal d-none d-sm-block","data-test":"videoPlayerWidget",isOpen:!l,toggle:i},u.a.createElement("audio",{controls:!0},u.a.createElement("source",{src:a,type:n}),"Your browser does not support the audio tag.")),document.getElementById(le.d)),u.a.createElement(ce.a,null,t)};function fe(e){return{"image/jpeg":"Image","video/mp4":"Video","video/webm":"Video","audio/webm":"Audio","video/ogg":"Video","application/ogg":"Unspecified","audio/mpeg":"Audio","audio/wav":"Audio","audio/mp4":"Audio"}[e]}var he=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(a=Object(o.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(c)))).getRenderForItem=function(){var e=a.props,t=e.fsInfo,n=e.item,r=e.inViewport,o=e.currentPath,l=o.remoteName,c=o.remotePath,i=n.MimeType,s="",m=localStorage.getItem(le.c);switch(s=t.Features.BucketBased?m+"[".concat(l,"]/").concat(c,"/").concat(n.Name):m+"[".concat(l,":").concat(c,"]/").concat(n.Name),i){case"image/jpeg":return u.a.createElement(de,{item:n,downloadURL:s,inViewport:r});case"video/mp4":case"video/webm":case"audio/webm":case"video/ogg":case"application/ogg":return u.a.createElement(me,{playbackURL:s,MimeType:i,currentPath:o});case"audio/mpeg":case"audio/wav":case"audio/mp4":return u.a.createElement(pe,{playbackURL:s,MimeType:i});default:return null}},a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.loadMedia,a=fe(e.item.MimeType)&&t?this.getRenderForItem():null;return u.a.createElement(ce.a,null,a)}}]),t}(u.a.Component),ge=Object(O.b)(function(e,t){var a=e.explorer.currentPaths[t.containerID],n=e.explorer.loadImages[t.containerID],r={},o=a.remoteName;if(a&&e.remote.configs){var l=o.split(":")[0];e.remote.configs[l]&&(r=e.remote.configs[l])}return{currentPath:a,fsInfo:r,loadMedia:n}},{})(he);function be(){return(be=Object(q.a)(V.a.mark(function e(t){var a,n,r,o,l,c,i,s;return V.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.srcRemoteName,n=t.srcRemotePath,r=t.destRemoteName,o=t.destRemotePath,l=t.Name,c=t.IsDir,i=t.dropEffect,s=t.updateHandler,"move"!==i){e.next=8;break}return e.next=4,Object(j.b)(a,n,r,o,l,c);case 4:s(),c?ee.b.info("Directory copying started in background: ".concat(l)):ee.b.info("File copying started in background: ".concat(l)),e.next=12;break;case 8:return e.next=10,Object(j.c)(a,n,r,o,l,c);case 10:s(),ee.b.info("Directory moving started in background: ".concat(l));case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Ee={canDrag:function(e){return!0},beginDrag:function(e){var t=e.item;return{Name:t.Name,Path:t.Path,IsDir:t.IsDir,remoteName:e.remoteName,remotePath:e.remotePath}},endDrag:function(e,t,a){console.log(e,"Component:",a);try{t.getDropResult()&&a&&function(e){be.apply(this,arguments)}(t.getDropResult())}catch(r){var n=r.response?r.response:r;console.log(JSON.stringify(n)),ee.b.error("Error copying file(s). ".concat(n),{autoClose:!1})}}};function ve(e){var t=e.IsDir,a=e.MimeType,n="fa-file";return t?n="fa-folder":"application/pdf"===a?n="fa-file-pdf-o":"image/jpeg"===a?n="fa-file-image-o":"application/rar"===a||"application/x-rar-compressed"===a||" application/zip"===a?n="fa-file-archive-o":"text/plain"===a?n="fa-file-text-o":"text/x-vcard"===a&&(n="fa-address-card-o"),u.a.createElement("i",{className:n+" fa fa-lg"})}function ye(e,t){window.confirm("Are you sure you want to delete ".concat(t.Name))&&e(t)}function Ne(e){var t=e.downloadHandle,a=e.deleteHandle,n=e.item,r=e.linkShareHandle;return n.IsDir?u.a.createElement(u.a.Fragment,null,u.a.createElement(Y.a,null,u.a.createElement(K.a,{color:"link"},u.a.createElement("i",{className:"fa fa-ellipsis-v"})),u.a.createElement(X.a,null,u.a.createElement(Z.a,{header:!0},"Actions"),u.a.createElement(Z.a,{onClick:function(){return r(n)}},u.a.createElement("i",{className:"fa fa-share fa-lg d-inline"})," Share with link"),u.a.createElement(Z.a,{divider:!0}),u.a.createElement(Z.a,{onClick:function(){return ye(a,n)}},u.a.createElement("i",{className:"fa fa-remove fa-lg d-inline text-danger"})," Delete ")))):u.a.createElement(u.a.Fragment,null,u.a.createElement(p.a,{color:"link",onClick:function(){return t(n)}},u.a.createElement("i",{className:"fa fa-cloud-download fa-lg d-inline"})),u.a.createElement(p.a,{color:"link"},u.a.createElement("i",{className:"fa fa-info-circle"})),u.a.createElement(Y.a,null,u.a.createElement(K.a,{color:"link"},u.a.createElement("i",{className:"fa fa-ellipsis-v"})),u.a.createElement(X.a,null,u.a.createElement(Z.a,{header:!0},"Actions"),u.a.createElement(Z.a,{onClick:function(){return r(n)}},u.a.createElement("i",{className:"fa fa-share fa-lg d-inline"})," Share with link"),u.a.createElement(Z.a,{divider:!0}),u.a.createElement(Z.a,{onClick:function(){return ye(a,n)}},u.a.createElement("i",{className:"fa fa-remove fa-lg d-inline text-danger"})," Delete "))))}var ke=function(e){function t(){return Object(n.a)(this,t),Object(o.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(r.a)(t,[{key:"handleClick",value:function(e,t,a,n){e&&t(a,n)}},{key:"render",value:function(){var e,t=this,a=this.props,n=a.containerID,r=a.inViewport,o=a.item,l=a.loadImages,c=a.clickHandler,i=a.downloadHandle,s=a.linkShareHandle,m=a.deleteHandle,d=a.connectDragSource,p=a.gridMode,h=a.itemIdx,b=o.IsDir,E=o.MimeType,v=o.ModTime,y=o.Name,N=o.Size,k=new Date(Date.parse(v));return e=d("card"===p?u.a.createElement("div",{className:b?"":"col-md-4"},u.a.createElement(f.a,null,u.a.createElement(g.a,{onClick:function(e){return t.handleClick(b,c,e,o)}},l&&fe(E)?u.a.createElement(ge,{containerID:n,item:o,inViewport:r}):u.a.createElement(ve,{IsDir:b,MimeType:E}),y),u.a.createElement($.a,null,u.a.createElement(Ne,{downloadHandle:i,linkShareHandle:s,deleteHandle:m,item:o})))):u.a.createElement("tr",{className:"pointer-cursor"},u.a.createElement("td",{className:"d-none d-md-table-cell"},u.a.createElement("input",{type:"checkbox"})),u.a.createElement("td",{onClick:function(e){return c(e,o)},id:"file"+h},u.a.createElement(ve,{IsDir:b,MimeType:E})," ",y),u.a.createElement("td",null,-1===N?"-":Object(D.g)(N,2)),u.a.createElement("td",{className:"d-none d-md-table-cell"},k.toLocaleDateString()),u.a.createElement("td",null,u.a.createElement(Ne,{downloadHandle:i,linkShareHandle:s,deleteHandle:m,item:o})))),u.a.createElement(ce.a,null,e)}}]),t}(u.a.Component),Oe=ae()(ke,{rootMargin:"-1.0px"}),we=Object(J.DragSource)(_,Ee,function(e,t){return{connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:t.isDragging()}})(Oe),je=a(50),Ce=a(791),De=a(792),Ie=a(434),Fe=a(793),Pe=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(l.a)(t).call(this,e))).copyToClipboard=function(){var e=document.createElement("textarea");e.innerText=a.props.linkUrl,document.body.appendChild(e),e.select(),document.execCommand("copy"),e.remove()},a.handleFocus=function(e){return e.target.select()},a.state={copySuccess:""},a.toggle=a.toggle.bind(Object(c.a)(a)),a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"toggle",value:function(){this.props.closeModal()}},{key:"render",value:function(){var e=this.props,t=e.isVisible,a=e.linkUrl,n=this.state.copySuccess,r=!document||!document.queryCommandSupported||document.queryCommandSupported("copy");return u.a.createElement("div",null,u.a.createElement(re.a,{isOpen:t,toggle:this.toggle},u.a.createElement(Ce.a,{toggle:this.toggle,"data-test":"modalHeader"},"Public link generated."),u.a.createElement(De.a,{"data-test":"modalBody"},u.a.createElement(Ie.a,{readOnly:!0,value:a,onFocus:this.handleFocus}),r&&u.a.createElement("div",null,u.a.createElement(p.a,{color:"link",onClick:this.copyToClipboard},u.a.createElement("i",{className:"fa fa-clipboard fa-2x"}))),n),u.a.createElement(Fe.a,{"data-test":"modalFooter"},u.a.createElement(p.a,{color:"primary",onClick:this.toggle},"Done")," ")))}}]),t}(u.a.Component);Pe.defaultProps={isVisible:!0};var Se=Pe;var Me=function(e){var t=e.height,a=e.children;return u.a.createElement("div",{style:{overflow:"auto",height:t}},a)},xe={drop:function(e,t,a){if(!t.didDrop()){var n=t.getItem(),r=n.Name,o=n.Path,l=n.IsDir,c=n.remoteName;return{srcRemoteName:Object(D.a)(c),srcRemotePath:o,destRemoteName:Object(D.a)(e.currentPath.remoteName),destRemotePath:e.currentPath.remotePath,Name:r,IsDir:l,updateHandler:a.updateHandler}}},canDrop:function(e,t){var a=t.getItem(),n=a.remoteName,r=a.remotePath;console.log(n,e.currentPath.remoteName,r,e.currentPath.remotePath);var o=e.currentPath.remoteName,l=e.currentPath.remotePath;return o!==n||l!==r}};function Re(e){var t=e.upButtonHandle;return"card"===e.gridMode?u.a.createElement(m.a,{lg:12},u.a.createElement(p.a,{onClick:function(){return t()}},"Go Up")):u.a.createElement("tr",{onClick:function(){return t()},className:"pointer-cursor"},u.a.createElement("td",{colSpan:1}),u.a.createElement("td",{colSpan:4},u.a.createElement("i",{className:"fa fa-file-o"})," Go Up..."))}var Le=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(l.a)(t).call(this,e))).closeLinkShareModal=function(){a.setState({showLinkShareModal:!1})},a.showLinkShareModal=function(){a.setState({showLinkShareModal:!0})},a.updateHandler=function(){var e=a.props.currentPath,t=e.remoteName,n=e.remotePath;a.getFilesList(t,n)},a.dismissAlert=function(e){a.setState({isDownloadProgress:!1})},a.linkShareHandle=function(e){if(a.props.fsInfo.Features.PublicLink){var t=a.props.currentPath.remoteName;j.a.post(L.a.createPublicLink,{fs:Object(D.a)(t),remote:e.Path}).then(function(e){a.setState({generatedLink:e.data.url,showLinkShareModal:!0})},function(e){ee.b.error("Error Generating link: "+e)})}else ee.b.error("This remote does not support public link")},a.getFileComponents=function(e){var t=a.props,n=t.files,r=t.containerID,o=t.gridMode,l=t.fsInfo,c=t.loadImages,i=a.props.currentPath,s=i.remoteName,m=i.remotePath;if(l&&!Object(D.h)(l))return n.map(function(t,n){var i=t.ID,d=t.Name;return void 0===i&&(i=d),t.IsDir===e?u.a.createElement(u.a.Fragment,{key:i},u.a.createElement(we,{item:t,clickHandler:a.handleFileClick,downloadHandle:a.downloadHandle,deleteHandle:a.deleteHandle,remoteName:s,remotePath:m,gridMode:o,containerID:r,linkShareHandle:a.linkShareHandle,loadImages:c,isBucketBased:l.Features.BucketBased,canCopy:l.Features.Copy,canMove:l.Features.Move,itemIdx:n})):null})},a.state={isLoading:!1,isDownloadProgress:!1,downloadingItems:0,shouldUpdate:!0,showLinkShareModal:!1,generatedLink:""},a.handleFileClick=a.handleFileClick.bind(Object(c.a)(a)),a.downloadHandle=a.downloadHandle.bind(Object(c.a)(a)),a.deleteHandle=a.deleteHandle.bind(Object(c.a)(a)),a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"handleFileClick",value:function(e,t){var a=t.Path,n=t.IsDir,r=t.IsBucket;n||r?this.updateRemotePath(a,n,r):this.downloadHandle(t)}},{key:"updateRemotePath",value:function(e,t,a){var n=this.props.currentPath.remoteName,r="",o="";a?(r=Object(D.a)(n)+e,o=""):t&&(r=n,o=e),this.props.changePath(this.props.containerID,r,o)}},{key:"getFilesList",value:function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0];var e=this.props.currentPath,t=e.remoteName,a=e.remotePath;this.props.getFiles(t,a)}},{key:"downloadHandle",value:function(){var e=Object(q.a)(V.a.mark(function e(t){var a,n,r,o,l,c,i,s,u=this;return V.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.props.currentPath,n=a.remoteName,r=a.remotePath,o=this.props.fsInfo,l="",l=o.Features.BucketBased?"/[".concat(n,"]/").concat(r,"/").concat(t.Name):"/[".concat(n,":").concat(r,"]/").concat(t.Name),this.setState(function(e){return{downloadingItems:e.downloadingItems+1,isDownloadProgress:!0}}),e.next=7,Object(j.a)({url:l,method:"GET",responseType:"blob"});case 7:c=e.sent,i=window.URL.createObjectURL(new Blob([c.data])),(s=document.createElement("a")).href=i,s.setAttribute("download",t.Name),document.body.appendChild(s),s.click(),this.setState(function(e){return{downloadingItems:e.downloadingItems-1}},function(){0===u.state.downloadingItems&&u.setState({isDownloadProgress:!1})});case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"deleteHandle",value:function(){var e=Object(q.a)(V.a.mark(function e(t){var a,n;return V.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.props.currentPath.remoteName,n={fs:Object(D.a)(a),remote:t.Path},e.prev=2,!t.IsDir){e.next=10;break}return e.next=6,j.a.post(L.a.purge,n);case 6:this.updateHandler(),ee.b.info("".concat(t.Name," deleted.")),e.next=14;break;case 10:return e.next=12,j.a.post(L.a.deleteFile,n);case 12:this.updateHandler(),ee.b.info("".concat(t.Name," deleted."),{autoClose:!1});case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(2),ee.b.error("Error deleting file. ".concat(e.t0),{autoClose:!1});case 19:case"end":return e.stop()}},e,this,[[2,16]])}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.isLoading,a=e.isDownloadProgress,n=e.downloadingItems,r=e.generatedLink,o=e.showLinkShareModal,l=this.props,c=l.connectDropTarget,i=l.isOver,s=l.files,p=l.navigateUp,f=l.containerID,h=l.gridMode,g=l.canDrop,b=this.props.currentPath.remoteName;if(t||!s)return u.a.createElement("div",null,u.a.createElement(G.a,{color:"primary"})," Loading");if(""===b)return u.a.createElement("div",null,"No remote is selected. Select a remote from above to show files.");var E=this.getFileComponents(!0),v=this.getFileComponents(!1),y="";return y="card"===h?u.a.createElement(Q.a,{fluid:!0},u.a.createElement(d.a,null,u.a.createElement(Re,{upButtonHandle:function(){return p(f)},gridMode:h})),u.a.createElement(d.a,null,u.a.createElement(m.a,{lg:3},u.a.createElement("h3",null,"Directories"),u.a.createElement(Me,{height:le.b},E)),u.a.createElement(m.a,{lg:9},u.a.createElement("h3",null,"Files"),u.a.createElement(Me,{height:le.b},u.a.createElement(d.a,null,v))))):u.a.createElement(Q.a,{fluid:!0,className:"pd-0"},u.a.createElement(Me,{height:le.b},u.a.createElement(z.a,{className:"table-responsive-sm"},u.a.createElement("thead",null,u.a.createElement("tr",null,u.a.createElement("th",{className:"d-none d-md-table-cell"},"x"),u.a.createElement("th",null,"Name"),u.a.createElement("th",null,"Size"),u.a.createElement("th",{className:"d-none d-md-table-cell"},"Modified"),u.a.createElement("th",null,"Actions"))),u.a.createElement("tbody",null,u.a.createElement(Re,{upButtonHandle:function(){return p(f)},gridMode:h}),s.length>0?u.a.createElement(u.a.Fragment,null,u.a.createElement("tr",null,u.a.createElement("td",{colSpan:1,className:"d-none d-md-block"}),u.a.createElement("th",{colSpan:4},"Directories")),E,u.a.createElement("tr",null,u.a.createElement("td",{className:"d-none d-md-table-cell"}),u.a.createElement("th",null,"Files"),u.a.createElement("td",{className:"d-none d-md-table-cell"}),u.a.createElement("td",null),u.a.createElement("td",null)),v):u.a.createElement("tr",null,u.a.createElement("td",{colSpan:1,className:"d-none d-md-table-cell"}),u.a.createElement("th",{colSpan:4},"Files")))))),c(u.a.createElement("div",{className:"row"},i&&g&&u.a.createElement("div",{style:{position:"absolute",top:0,left:0,height:"100%",width:"100%",zIndex:1,opacity:.5,backgroundColor:"gray"}}),u.a.createElement(ce.a,null,u.a.createElement(W.a,{color:"info",isOpen:a,toggle:this.dismissAlert,sm:12,lg:12},"Downloading ",n," file(s). Please wait."),y,u.a.createElement(Se,{closeModal:this.closeLinkShareModal,isVisible:o,linkUrl:r}))))}}]),t}(u.a.PureComponent);Le.defaultProps={};var Te=Object(je.compose)(Object(O.b)(function(e,t){var a=e.explorer.currentPaths[t.containerID],n=e.explorer.visibilityFilters[t.containerID],r=e.explorer.gridMode[t.containerID],o=e.explorer.searchQueries[t.containerID],l=e.explorer.loadImages[t.containerID],c={},i=a.remoteName,s=a.remotePath;if(a&&e.remote.configs){var u=i.split(":")[0];e.remote.configs[u]&&(c=e.remote.configs[u])}var m="".concat(i,"-").concat(s),d=e.remote.files[m];return d&&(d=d.files,n&&(d=Object(D.d)(d,n)),o&&(d=Object(D.e)(d,o))),{files:d,currentPath:a,fsInfo:c,gridMode:r,searchQuery:o,loadImages:l}},{getFiles:T,navigateUp:M,changePath:I}),Object(J.DropTarget)(_,xe,function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver(),canDrop:t.canDrop()}}))(Le),He=a(799),Ae=a(803),Be=a(447),Ue=a(448),Ve=a(783),qe=a(518),Ge=a(519),Qe=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(l.a)(t).call(this,e))).disableForm=function(e){a.setState({disableForm:e})},a.changeName=function(e){var t=e.target.value;a.setState({name:t})},a.state={name:"",disableForm:!1},a.createNewFolder=a.createNewFolder.bind(Object(c.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(c.a)(a)),a.toggle=a.toggle.bind(Object(c.a)(a)),a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"createNewFolder",value:function(){var e=Object(q.a)(V.a.mark(function e(){var t,a,n,r,o,l;return V.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.name,a=this.props.currentPath,n=a.remoteName,r=a.remotePath,o=this.props.fsInfo,n=Object(D.a)(n),e.prev=4,o.Features.BucketBased&&""===r?n+=t:""===r?r=t:r+="/"+t,l={fs:n,remote:r},this.disableForm(!0),e.next=10,j.a.post(L.a.mkdir,l);case 10:this.disableForm(!1),this.toggle(),ee.b.info("Folder created: ".concat(r)),this.props.getFilesForContainerID(this.props.containerID),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(4),this.disableForm(!1),e.t0.response?ee.b.error("Error creating folder: ".concat(e.t0.response.data.error)):ee.b.error("Error creating folder: ".concat(e.t0));case 20:case"end":return e.stop()}},e,this,[[4,16]])}));return function(){return e.apply(this,arguments)}}()},{key:"handleSubmit",value:function(e){e.preventDefault(),this.createNewFolder()}},{key:"toggle",value:function(){this.props.closeModal()}},{key:"render",value:function(){var e=this.state,t=e.name,a=e.disableForm,n=this.props,r=n.isVisible,o=n.currentPath;return u.a.createElement(re.a,{isOpen:r,toggle:this.toggle,"data-test":"newFolderComponent"},u.a.createElement(H.a,{onSubmit:this.handleSubmit},u.a.createElement(Ce.a,{toggle:this.toggle},"Create New folder at ",o.remoteName,": ",o.remotePath),u.a.createElement(De.a,null,u.a.createElement(qe.a,{row:!0},u.a.createElement(Ge.a,{for:"folderName",sm:5},"Enter the name"),u.a.createElement(m.a,{sm:7},u.a.createElement(Ie.a,{type:"text",name:"folderName",id:"folderName",value:t,onChange:this.changeName,required:!0,autoFocus:!0}))),u.a.createElement("div",{className:"clearfix"},u.a.createElement(p.a,{type:"submit",color:"success",className:"float-right",disabled:a},u.a.createElement("i",{className:"fa fa-check fa-lg"}),"Create folder")))))}}]),t}(u.a.Component),ze=Object(O.b)(function(e,t){var a=e.explorer.currentPaths[t.containerID],n={};return a&&e.remote.configs&&e.remote.configs[a.remoteName]&&(n=e.remote.configs[a.remoteName]),{currentPath:a,fsInfo:n}},{getFilesForContainerID:P})(Qe),We=a(471),Je=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(l.a)(t).call(this,e))).openNewFolderModal=function(){var e=a.props.fsInfo;e&&e.Features&&e.Features.CanHaveEmptyDirectories?a.setState({newFolderModalIsVisible:!0}):ee.b.error("This remote cannot have empty directories")},a.closeNewFolderModal=function(){a.setState({newFolderModalIsVisible:!1})},a.handleChangeFilter=function(e){var t=e.target.value;(0,a.props.changeVisibilityFilter)(a.props.containerID,t),a.toggleDropDown()},a.handleChangeGridMode=function(e){var t=e.target.value;(0,a.props.changeGridMode)(a.props.containerID,t),a.toggleDropDown()},a.changeSearch=function(e){e.preventDefault();var t=a.props.containerID;a.props.setSearchQuery(t,e.target.value)},a.toggleDropDown=function(){a.setState(function(e){return{dropdownOpen:!e.dropdownOpen}})},a.toggleAboutModal=function(){var e=a.props.fsInfo;e&&e.Features&&e.Features.About?a.setState(function(e){return{isAboutModalOpen:!e.isAboutModalOpen}},function(){if(a.state.isAboutModalOpen){var e=a.props.containerID;a.props.getAbout(e)}}):ee.b.error("This remote does not support About")},a.handleCleanTrash=function(){var e=a.props.fsInfo;if(e&&e.Features&&e.Features.CleanUp){if(window.confirm("Are you sure you want to clear the trash. This operation cannot be undone")){var t=a.props,n=t.currentPath,r=t.containerID,o=n.remoteName;Object(D.i)(o)||(o=Object(D.a)(o)),j.a.post(L.a.cleanUpRemote,{fs:o}).then(function(e){200===e.status&&(Object(ee.b)("Trash Cleaned"),a.props.getAbout(r))},function(e){ee.b.error("Error clearing trash")})}}else ee.b.error("Clearing trash is not allowed on this remote")},a.changeLoadMedia=function(e){e.stopPropagation();var t=a.props;(0,t.setLoadImages)(t.containerID,!t.loadImages)},a.state={newFolderModalIsVisible:!1,isAboutModalOpen:!1,dropdownOpen:!1},a.filterOptions=le.h,a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.containerID,a=e.loadImages,n=e.getFilesForContainerID,r=e.visibilityFilter,o=e.gridMode,l=e.navigateFwd,c=e.navigateBack,i=e.searchQuery,s=e.currentPath,f=e.doughnutData,h=this.state,g=h.newFolderModalIsVisible,b=h.dropdownOpen,E=h.isAboutModalOpen,v=s.remoteName,y=s.remotePath;return u.a.createElement("nav",{"aria-label":"breadcrumb"},u.a.createElement("ol",{className:"breadcrumb"},u.a.createElement("li",{className:"breadcrumb-item active"},v,":/"),y,u.a.createElement("li",{className:"breadcrumb-menu"},u.a.createElement("div",{className:"btn-group",role:"group","aria-label":"Button group with nested dropdown"},u.a.createElement(p.a,{onClick:this.toggleAboutModal,className:"btn"},u.a.createElement("i",{className:"cui-settings"})," Settings")))),u.a.createElement("div",null,u.a.createElement(p.a,{color:"light",className:"mr-1 btn-outline-dark",onClick:function(){return c(t)}},u.a.createElement("i",{className:"fa fa-lg fa-angle-left"})),u.a.createElement(p.a,{color:"light",className:"mr-1 btn-outline-dark",onClick:function(){return l(t)}},u.a.createElement("i",{className:"fa fa-lg fa-angle-right"})),u.a.createElement("div",{className:"float-right mb-3 mt-1 form-inline"},u.a.createElement(He.a,null,u.a.createElement(p.a,{className:"mr-1 btn-outline-dark",onClick:this.openNewFolderModal},u.a.createElement("i",{className:"fa fa-lg fa-plus"})," "),u.a.createElement(p.a,{className:"mr-1 btn-outline-dark",onClick:function(){return n(t)}},u.a.createElement("i",{className:"fa fa-lg fa-repeat"})),u.a.createElement(p.a,{className:"mr-1 "+(a?"btn-dark":"btn-outline-dark"),onClick:this.changeLoadMedia},u.a.createElement("i",{className:"fa fa-lg fa-picture-o",id:"LoadMediaButton"})),u.a.createElement(Ae.a,{placement:"right",target:"LoadMediaButton"},"Load Media"),u.a.createElement(Be.a,null,u.a.createElement(Ue.a,{addonType:"prepend"},u.a.createElement(p.a,{style:{zIndex:1},type:"button",color:"primary"},u.a.createElement("i",{className:"fa fa-search"})," Search")),u.a.createElement(Ie.a,{type:"text",id:"input1-group2",placeholder:"Search",value:i,onChange:this.changeSearch})),u.a.createElement(Ve.a,{isOpen:b,toggle:this.toggleDropDown},u.a.createElement(K.a,{caret:!0},"More"),u.a.createElement(X.a,null,u.a.createElement(Z.a,null,"View Type"," ",u.a.createElement(Ie.a,{type:"select",onClick:function(e){return e.stopPropagation()},onChange:this.handleChangeGridMode,value:o},u.a.createElement("option",{value:"grid"},"Table"),u.a.createElement("option",{value:"card"},"Card"))),u.a.createElement(Z.a,null,"File Filter"," ",u.a.createElement(Ie.a,{type:"select",onClick:function(e){return e.stopPropagation()},onChange:this.handleChangeFilter,value:r,className:"ml-1 mr-1"},u.a.createElement("option",{key:0},"None"),this.filterOptions.map(function(e,t){return u.a.createElement("option",{key:e,value:e},e)})))))),u.a.createElement(ze,{containerID:t,isVisible:g,closeModal:this.closeNewFolderModal}),u.a.createElement(re.a,{isOpen:E,toggle:this.toggleAboutModal},u.a.createElement(Ce.a,null,"Status for ",v),u.a.createElement(De.a,null,u.a.createElement(d.a,null,u.a.createElement(m.a,{sm:12},u.a.createElement("div",{className:"chart-wrapper"},u.a.createElement("p",null,"Space Usage (in GB)"),f&&!Object(D.h)(f)?u.a.createElement(We.a,{data:f}):u.a.createElement(u.a.Fragment,null,u.a.createElement(G.a,{color:"primary"}),"Loading")))),u.a.createElement(d.a,null,u.a.createElement(m.a,{sm:12},u.a.createElement(p.a,{color:"danger",onClick:this.handleCleanTrash},"Clean Trash ",u.a.createElement("i",{className:"fa fa-lg fa-trash"}))))),u.a.createElement(Fe.a,null)))))}}]),t}(u.a.Component),Ye=Object(O.b)(function(e,t){var a=e.providerStatus.about[t.containerID],n={},r=e.explorer.currentPaths[t.containerID],o={};if(r&&e.remote.configs&&e.remote.configs[r.remoteName]&&(o=e.remote.configs[r.remoteName]),a){for(var l=[],c=[],i=0,s=Object.entries(a);i<s.length;i++){var u=s[i],m=Object(ne.a)(u,2),d=m[0],p=m[1];"total"!==d&&(l.push(d),c.push(Object(D.b)(p).toFixed(2)))}l.length>1&&c.length>1&&(n={labels:l,datasets:[{data:c,backgroundColor:["#FF6384","#36A2EB","#FFCE56","#ff7459"],hoverBackgroundColor:["#FF6384","#36A2EB","#FFCE56","#ff7459"]}]})}return{visibilityFilter:e.explorer.visibilityFilters[t.containerID],loadImages:e.explorer.loadImages[t.containerID],currentPath:e.explorer.currentPaths[t.containerID],gridMode:e.explorer.gridMode[t.containerID],searchQuery:e.explorer.searchQueries[t.containerID],fsInfo:o,doughnutData:n}},{changeVisibilityFilter:function(e,t){return function(a){a({type:C.l,id:e,filter:t})}},changeGridMode:function(e,t){return function(a){a({type:C.d,id:e,mode:t})}},navigateBack:R,navigateFwd:x,getFilesForContainerID:P,setSearchQuery:function(e,t){return function(a){a({type:C.k,id:e,searchQuery:t})}},getAbout:function(e){return function(t,a){var n=a().explorer.currentPaths[e].remoteName;n&&(Object(D.i)(n)||(n=Object(D.a)(n)),t({type:C.u,status:C.C,id:e,payload:{}}),j.a.post(L.a.getAbout,{fs:n}).then(function(a){t({type:C.u,status:C.C,id:e,payload:a.data})},function(a){t({type:C.u,status:C.A,id:e,error:a})}))}},setLoadImages:function(e,t){return function(a){a({type:C.g,id:e,payload:t})}}})(Je),Ke=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(l.a)(t).call(this,e))).state={remoteNameTemp:""},a.updateRemoteName=a.updateRemoteName.bind(Object(c.a)(a)),a.updateRemotePath=a.updateRemotePath.bind(Object(c.a)(a)),a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"updateRemoteName",value:function(e){this.setState({remoteNameTemp:e})}},{key:"updateRemotePath",value:function(e,t,a){var n=this.props.currentPath.remoteName,r="",o="";a?(r=Object(D.a)(n)+e,o=""):t&&(r=n,o=e),this.props.changePath(this.props.containerID,r,o)}},{key:"render",value:function(){var e=this.props.currentPath.remoteName,t=this.props,a=t.containerID,n=t.distractionFreeMode,r=e&&""!==e;return u.a.createElement(ce.a,null,!n&&u.a.createElement(f.a,null,u.a.createElement(h.a,null,"Remotes"),u.a.createElement(g.a,null,u.a.createElement(B,{remoteName:e,containerID:a}))),r&&u.a.createElement(f.a,null,u.a.createElement(h.a,null,u.a.createElement(Ye,{containerID:a})),u.a.createElement(g.a,null,u.a.createElement(Te,{containerID:a}))))}}]),t}(u.a.Component);Ke.defaultProps={};var Xe=Object(O.b)(function(e,t){var a=e.explorer.currentPaths[t.containerID],n={},r=a.remoteName;if(a&&e.remote.configs){var o=r.split(":")[0];e.remote.configs[o]&&(n=e.remote.configs[o])}return{configs:e.remote.configs,hasError:e.remote.hasError,error:e.remote.error,currentPath:e.explorer.currentPaths[t.containerID],fsInfo:n}},{createPath:S,changePath:I,changeRemoteName:F,changeRemotePath:function(e,t){return function(a){a({type:C.j,id:e,remotePath:t}),a(P(e))}},navigateUp:M,navigateBack:R,navigateFwd:x})(Ke),Ze=a(772),$e=a.n(Ze);function _e(e){for(var t=e.cols,a=e.distractionFreeMode,n=[],r=12/t,o=0;o<t;o++)n.push(u.a.createElement(m.a,{xs:12,sm:12,md:r,lg:r,key:o},u.a.createElement(Xe,{containerID:o.toString(),distractionFreeMode:a})));return n}var et=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(l.a)(t).call(this,e))).changeLayout=function(e,t){var n=a.props.changeNumCols;"side"===t&&e!==n&&n(e)},a.toggleDistractionFreeMode=function(e){var t=a.props,n=t.distractionFreeMode;(0,t.changeDistractionFreeMode)(!n)},a.changeLayout=a.changeLayout.bind(Object(c.a)(a)),a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.numCols,a=e.changeNumCols;t<1&&a(1)}},{key:"render",value:function(){var e=this,t=this.props,a=t.numCols,n=t.backStacks,r=t.distractionFreeMode;return u.a.createElement(ce.a,null,u.a.createElement(d.a,{className:"d-none d-md-block","data-test":"remoteExplorerLayout"},r&&u.a.createElement("div",{className:"clearfix float-right"},u.a.createElement(p.a,{color:"success",className:"ml-2",onClick:this.toggleDistractionFreeMode},u.a.createElement("i",{className:"fa fa-arrows"}))),!r&&u.a.createElement(m.a,{sm:12,lg:12},u.a.createElement(f.a,null,u.a.createElement(h.a,null,"Choose Layout"),u.a.createElement(g.a,null,u.a.createElement(p.a,{color:"primary",className:"ml-2",onClick:function(){return e.changeLayout(1,"side")}},"1 - side by side"),u.a.createElement(p.a,{color:"primary",className:"ml-2",onClick:function(){return e.changeLayout(2,"side")}},"2 - side by side"),u.a.createElement(p.a,{color:"primary",className:"ml-2",onClick:function(){return e.changeLayout(3,"side")}},"3 - side by side"),u.a.createElement(p.a,{color:"primary",className:"ml-2",onClick:function(){return e.changeLayout(4,"side")}},"4 - side by side"),u.a.createElement(p.a,{color:"success",className:"ml-2",onClick:this.toggleDistractionFreeMode},u.a.createElement("i",{className:"fa fa-arrows"})))))),u.a.createElement(d.a,null,u.a.createElement(_e,{cols:a,backStacks:n,distractionFreeMode:r})))}}]),t}(u.a.Component);t.default=Object(je.compose)(Object(O.b)(function(e){return{backStacks:e.explorer.backStacks,numCols:e.remote.numCols,distractionFreeMode:e.remote.distractionFreeMode}},{createPath:S,changeNumCols:function(e){return function(t){if(!e||e<0)throw new Error("Invalid number of cols:".concat(e));for(var a=0;a<e;a++)t(S(a.toString()));t({type:C.f,payload:{numCols:e}})}},changeDistractionFreeMode:function(e){return function(t){t({type:C.c,payload:e})}}}),Object(J.DragDropContext)($e.a))(et)}}]);
//# sourceMappingURL=19.2f2e218e.chunk.js.map